"use strict";(self.webpackChunkmeteoscientific=self.webpackChunkmeteoscientific||[]).push([[4042],{91:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>d,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var i=t(4848),o=t(8453);const s={sidebar_position:2},r="Setting Up GRPC",c={id:"tutorial-extras/GRPC",title:"Setting Up GRPC",description:"I've gotten a bunch of requests to use GRPC.  It's definitely beyond the scope of both my expertise (minimal) and scope at MetSci to walk you through it.  As you'll see in the documentation, it's not well documented and you should expect things to break.",source:"@site/docs/tutorial-extras/002-GRPC.md",sourceDirName:"tutorial-extras",slug:"/tutorial-extras/GRPC",permalink:"/website/docs/tutorial-extras/GRPC",draft:!1,unlisted:!1,editUrl:"https://github.com/meteoscientific/website/tree/main/docs/tutorial-extras/002-GRPC.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Documentation",permalink:"/website/docs/tutorial-extras/documentation"},next:{title:"Working With REST-API",permalink:"/website/docs/tutorial-extras/working-with-REST-API"}},a={},l=[{value:"ChirpStack gRPC API Access Guide (Tenant Account)",id:"chirpstack-grpc-api-access-guide-tenant-account",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Setting Up Your Environment",id:"step-1-setting-up-your-environment",level:2},{value:"Step 2: Connecting to ChirpStack",id:"step-2-connecting-to-chirpstack",level:2},{value:"2.1 Obtaining the API Token",id:"21-obtaining-the-api-token",level:3},{value:"2.2 Making Your First gRPC Call",id:"22-making-your-first-grpc-call",level:3},{value:"Step 3: Exploring Further",id:"step-3-exploring-further",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Conclusion",id:"conclusion",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"setting-up-grpc",children:"Setting Up GRPC"})}),"\n",(0,i.jsx)(n.p,{children:"I've gotten a bunch of requests to use GRPC.  It's definitely beyond the scope of both my expertise (minimal) and scope at MetSci to walk you through it.  As you'll see in the documentation, it's not well documented and you should expect things to break."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Note: This is GPT-generated guidance.  I've had so many requests for help with this that I thought I'd spin up a basic how-to, but this is well beyond what I know how to do.  It'll be mostly right, but may lead you wrong."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"chirpstack-grpc-api-access-guide-tenant-account",children:"ChirpStack gRPC API Access Guide (Tenant Account)"}),"\n",(0,i.jsxs)(n.p,{children:["Welcome to the ChirpStack gRPC API setup guide for tenant users! This tutorial is designed for those who have access to a ChirpStack instance through a tenant account and want to interface with the ChirpStack Application Server using gRPC. We\u2019ll guide you through the necessary steps to get started with gRPC, focusing on the ",(0,i.jsx)(n.code,{children:"console.meteoscientific.com"})," server."]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(n.p,{children:"Before we begin, make sure you have the following installed on your system:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"gRPC"}),": A high-performance RPC framework. You can find installation instructions ",(0,i.jsx)(n.a,{href:"https://grpc.io/docs/languages/",children:"here"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Protobuf Compiler (protoc)"}),": Required to compile the ",(0,i.jsx)(n.code,{children:".proto"})," files. Installation instructions are ",(0,i.jsx)(n.a,{href:"https://grpc.io/docs/protoc-installation/",children:"here"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"cURL"}),": To test the API endpoints. You can download it ",(0,i.jsx)(n.a,{href:"https://curl.se/download.html",children:"here"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Python/Node.js/Go"}),": Depending on your preferred programming language. Ensure the corresponding gRPC libraries are installed."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"step-1-setting-up-your-environment",children:"Step 1: Setting Up Your Environment"}),"\n",(0,i.jsxs)(n.p,{children:["Since you only have a tenant account, you won\u2019t be able to clone the ChirpStack API repository directly from the server. However, you can still generate the necessary gRPC client code by obtaining the ",(0,i.jsx)(n.code,{children:".proto"})," files from the ChirpStack GitHub repository."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Download the ChirpStack API ",(0,i.jsx)(n.code,{children:".proto"})," Files:"]})}),"\n",(0,i.jsxs)(n.p,{children:["Download the necessary ",(0,i.jsx)(n.code,{children:".proto"})," files from the ",(0,i.jsx)(n.a,{href:"https://github.com/brocaar/chirpstack-api",children:"ChirpStack GitHub repository"}),". You can either download the repository as a ZIP file or clone it to your local machine:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/brocaar/chirpstack-api\ncd chirpstack-api\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Generate gRPC Code:"})}),"\n",(0,i.jsxs)(n.p,{children:["Depending on your language of choice, compile the ",(0,i.jsx)(n.code,{children:".proto"})," files located in the ",(0,i.jsx)(n.code,{children:"proto/"})," directory."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"For Python:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"python -m grpc_tools.protoc -I . --python_out=. --grpc_python_out=. ./proto/*.proto\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"For Go:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"protoc --go_out=plugins=grpc:. ./proto/*.proto\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"For Node.js:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"grpc_tools_node_protoc --js_out=import_style=commonjs,binary:. --grpc_out=grpc_js:. ./proto/*.proto\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"step-2-connecting-to-chirpstack",children:"Step 2: Connecting to ChirpStack"}),"\n",(0,i.jsxs)(n.p,{children:["You will connect to the ",(0,i.jsx)(n.code,{children:"console.meteoscientific.com"})," server using the gRPC API."]}),"\n",(0,i.jsx)(n.h3,{id:"21-obtaining-the-api-token",children:"2.1 Obtaining the API Token"}),"\n",(0,i.jsx)(n.p,{children:"As a tenant user, you\u2019ll still need an API token to authenticate your gRPC requests. Follow these steps:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Log in to your ChirpStack tenant account at ",(0,i.jsx)(n.code,{children:"https://console.meteoscientific.com"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Navigate to ",(0,i.jsx)(n.strong,{children:"Your Organization"})," > ",(0,i.jsx)(n.strong,{children:"API Keys"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create"})," to generate a new API key."]}),"\n",(0,i.jsx)(n.li,{children:"Copy the generated API key and save it securely."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"22-making-your-first-grpc-call",children:"2.2 Making Your First gRPC Call"}),"\n",(0,i.jsx)(n.p,{children:"With the API key, you can now make your first gRPC call. Remember, your API token will limit your access to the resources associated with your tenant account."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Python Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import grpc\nimport chirpstack_api.as_pb.external.api.application_pb2_grpc as api_grpc\nimport chirpstack_api.as_pb.external.api.application_pb2 as api\n\n# Establish the channel\nchannel = grpc.insecure_channel('console.meteoscientific.com:8080')\n\n# Create the stub\nstub = api_grpc.ApplicationServiceStub(channel)\n\n# Prepare your request with the API token\nrequest = api.ListApplicationsRequest()\nmetadata = [('authorization', 'Bearer YOUR_API_TOKEN')]\n\n# Make the request\nresponse = stub.List(request, metadata=metadata)\n\n# Print the response\nprint(response)\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Go Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "context"\n    "log"\n\n    "google.golang.org/grpc"\n    "google.golang.org/grpc/metadata"\n    pb "github.com/brocaar/chirpstack-api/go/v3/as/external/api"\n)\n\nfunc main() {\n    conn, err := grpc.Dial("console.meteoscientific.com:8080", grpc.WithInsecure())\n    if err != nil {\n        log.Fatalf("did not connect: %v", err)\n    }\n    defer conn.Close()\n\n    client := pb.NewApplicationServiceClient(conn)\n\n    md := metadata.New(map[string]string{"authorization": "Bearer YOUR_API_TOKEN"})\n    ctx := metadata.NewOutgoingContext(context.Background(), md)\n\n    req := &pb.ListApplicationsRequest{}\n    res, err := client.List(ctx, req)\n    if err != nil {\n        log.Fatalf("could not list applications: %v", err)\n    }\n\n    log.Printf("Applications: %v", res)\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Node.js Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const grpc = require('@grpc/grpc-js');\nconst protoLoader = require('@grpc/proto-loader');\n\nconst packageDefinition = protoLoader.loadSync(\n    './proto/chirpstack-api/as/external/api/application.proto',\n    {\n        keepCase: true,\n        longs: String,\n        enums: String,\n        defaults: true,\n        oneofs: true\n    }\n);\n\nconst chirpstack = grpc.loadPackageDefinition(packageDefinition).api;\n\nconst client = new chirpstack.ApplicationService(\n    'console.meteoscientific.com:8080',\n    grpc.credentials.createInsecure()\n);\n\nconst metadata = new grpc.Metadata();\nmetadata.add('authorization', 'Bearer YOUR_API_TOKEN');\n\nclient.ListApplications({}, metadata, (err, response) => {\n    if (err) {\n        console.error(err);\n    } else {\n        console.log(response);\n    }\n});\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"step-3-exploring-further",children:"Step 3: Exploring Further"}),"\n",(0,i.jsxs)(n.p,{children:["With your tenant account, you\u2019ll be limited to managing and accessing the resources associated with your tenant. Explore the API methods available to you by referencing the ",(0,i.jsx)(n.a,{href:"https://www.chirpstack.io/application-server/api/",children:"ChirpStack API documentation"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Invalid Token"}),": Ensure your API token is correct and hasn\u2019t expired."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Insufficient Permissions"}),": Remember that as a tenant user, your permissions are limited to your tenant\u2019s resources."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Connection Issues"}),": Verify that ",(0,i.jsx)(n.code,{children:"console.meteoscientific.com"})," is reachable from your network."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"SSL/TLS Issues"}),": If you need to connect securely, consider using ",(0,i.jsx)(n.code,{children:"grpc.WithTransportCredentials"})," instead of ",(0,i.jsx)(n.code,{children:"grpc.WithInsecure()"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsxs)(n.p,{children:["This guide has walked you through the basic setup of using gRPC with ChirpStack on the ",(0,i.jsx)(n.code,{children:"console.meteoscientific.com"})," server using a tenant account. While your access might be limited compared to an administrative user, you can still interact programmatically with your tenant\u2019s resources. Happy coding!"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\n### Key Adjustments for Tenant Users:\n\n1. **API Key Generation**: Focus on generating API keys within the tenant account, as administrative access to the server is not available.\n2. **Permissions and Scope**: Make users aware that their access is limited to the resources within their tenant.\n3. **No Server-Side Modifications**: Users cannot modify the server or access logs, so troubleshooting is limited to API access and tenant-specific issues.\n4. **Usage Scenarios**: Examples and instructions should emphasize operations they can perform within the tenant's scope, such as managing applications, devices, and gateways linked to their tenant.\n\nThis guide should help users with tenant-only access to effectively interact with the ChirpStack server using gRPC.\n"})})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var i=t(6540);const o={},s=i.createContext(o);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);